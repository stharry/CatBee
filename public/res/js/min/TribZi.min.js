TribZi={init:function(_1){this.sessionData=_1;this.selectedRewardIndex=0;return this;},setRewardIndex:function(_2){this.selectedRewardIndex=_2;return this;},setCustomMessage:function(_3){this.sessionData.landing.customMessage=_3;return this;},setRecipients:function(_4){this.recipients=_4;return this;},requestData:function(_5,_6){var _7=this.sessionData.sharePoint;this.requestResult=null;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest();}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200&&this.requestResult==null){try{this.requestResult=JSON.parse(xmlhttp.responseText);if(_6!==null){_6(this.requestResult);}}catch(e){}}};try{var _8=jQuery.param(_5);xmlhttp.open("POST",_7,true);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.setRequestHeader("Content-Length",_8.length);xmlhttp.send(_8);}catch(e){}},shareToEmail:function(_9){return this.share("email",_9);},share:function(_a,_b){var _c={action:"share deal",context:{sendFrom:this.sessionData.order.customer.email,sendTo:this.recipients,customMessage:this.sessionData.landing.customMessage,deal:{id:this.sessionData.id},context:{type:_a},reward:{id:this.sessionData.landing.landingRewards[this.selectedRewardIndex].id}}};this.requestData(_c,_b);return this;},shareToFbc:function(_d,_e){var _f={action:"fill share",context:{"context":{"type":"facebook"},"deal":{"id":this.sessionData.id},"reward":{"id":this.sessionData.landing.landingRewards[_e].id}}};var _10=function(_11){try{FB.init({appId:_11.context.application.applicationCode,status:true,cookie:true});FB.ui({method:"feed",display:"popup",name:TribZi.sessionData.landing.customMessage,picture:TribZi.sessionData.order.items[0].url,redirect_uri:_11.context.application.redirectUrl,caption:" ",description:_11.message,link:_11.link},function(_12){if(_12&&_12.post_id){alert("Post was published."+_12.post_id);}else{alert("Post was not published.");}});}catch(e){alert("err"+e);}};this.requestData(_f,false,_10);return this;}};window.TribZi=TribZi;