cbf={catBeeHost:function(){return cbf.valOrDefault(cbfSettings.redirectTo,cbf.valOrDefault(cbf.getScriptParams("catbeeframe").host,"http://api.tribzi.com/CatBee/"))},viewPort:function(){var a=window,b="inner";"innerWidth"in window||(b="client",a=document.documentElement||document.body);return{width:a[b+"Width"],height:a[b+"Height"]}},loadScript:function(a,b){var c=document.createElement("script");c.type="text/javascript";c.src=a;c.onload=-1<navigator.userAgent.indexOf("MSIE")?c.onreadystatechange=
function(){("loaded"==this.readyState||"complete"==this.readyState)&&b&&b();"loading"!=this.readyState&&(c.onload=c.onreadystatechange=null)}:b;document.getElementsByTagName("head")[0].appendChild(c)},loadCss:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);document.getElementsByTagName("body")[0].appendChild(b)},byId:function(a){return document.getElementById(a)},byNameList:function(a){return document.getElementsByName(a)},
byName:function(a){a=cbf.byNameList(a);return 0<a.length?a[0]:null},byClassList:function(a,b){for(var c=null==b||"undefined"==typeof b?document.getElementsByTagName("*"):cbf.byId(b).getElementsByTagName("*"),d=-1,e,f=[];e=c[++d];)-1<(" "+cbf.valOrDefault(e["class"],e.className)+" ").indexOf(" "+a+" ")&&f.push(e);return f},byClass:function(a,b){var c=cbf.byClassList(a,b);return 0<c.length?c[0]:null},getDiv:function(a){return!cbf.valOrDefault(a,null)?null:cbf.valOrDefault(cbf.byId(a),cbf.valOrDefault(cbf.byName(a),
cbf.byClass(a)))},addDiv:function(a,b,c){var d=document.createElement("div");d.id=a;null===b||"undefined"==typeof b?document.body.appendChild(d):(a=cbf.getDiv(b),(c=cbf.getDiv(c))?a.insertBefore(d,c):a.appendChild(d));return this},css:function(a,b){var c=cbf.byId(a);if("undefined"!=typeof c)for(key in b)try{"string"==typeof c.style[key]&&(c.style[key]=b[key])}catch(d){}return this},setZIndex:function(a,b){cbf.css(a,{"z-index":b});cbf.byId(a).zIndex=b;cbf.byId(a).style.zIndex=b},addEvt:function(a,
b,c){a=cbf.byId(a);a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},addLoadEvt:function(a){if(window.attachEvent)window.attachEvent("onload",a);else if(window.onload){var b=window.onload;window.onload=function(){b();a()}}else window.onload=a},isMobileClient:function(){var a={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},
Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return a.Android()||a.BlackBerry()||a.iOS()||a.Opera()||a.Windows()}};return a.any()},valOrDefault:function(a,b){return null===a||"undefined"==typeof a?b:a},getCatBeeUrl:function(){return cbf.catBeeHost()},setCookie:function(a,b,c){var d=new Date;d.setDate(d.getDate()+c);b=escape(b)+(null==c?"":"; expires="+d.toUTCString());document.cookie=a+"="+b},getCookie:function(a){var b,
c,d,e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==a)return unescape(d)},parseUrl:function(a){a=a.split("?")[1];if(!a||"undefined"==typeof a)return{};a=a.split("&");for(var b={},c=0;c<a.length;c++){var d=a[c].split("=");b[d[0]]=1<d.length?d[1]:null}return b},getScriptParams:function(a){for(var b=document.getElementsByTagName("script"),c=null,d=0;d<b.length;d++)if(0<b[d].src.toString().indexOf(a)){c=
b[d];break}if(c){a=c.src.replace(/^[^\?]+\??/,"").split("&");b={};for(d=0;d<a.length;d++){var e=a[d].split("=");b[e[0]]=decodeURI(e[1]).replace(/\+/g," ")}b.scriptSource=c.src;return b}return{scriptSource:""}},buildUrl:function(a){return cbf.valOrDefault(a.customUrl,this.getCatBeeUrl()+"api/deal/?action="+a.catbeeAction+"&context="+encodeURIComponent(JSON.stringify(a.urlParams)))},setupRpc:function(a){url=this.buildUrl(a);new easyXDM.Rpc({remote:url,onReady:function(){},container:document.getElementById("cbfContainer"),
props:{style:{padding:"0px 0px 0px 0px",overflow:"hidden",width:"100%",height:"100%"}}},{local:{resizeFrame:function(a,c){var d={height:c+"px",width:a+"px"};cbf.css("cbfContainer",d);cbf.css("cbfFrame",d)},closeFrame:function(){cbf.closeFrame()},sendCookieToFrame:function(a,c){cbf.setCookie(a,c,1)},showAddressBook:function(){cloudsponge.launch()}},remote:{}});return this},highZIndex:function(){function a(a,b){var c,d,e=document.defaultView||window;1==a.nodeType&&(c=b.replace(/\-([a-z])/g,function(a,
b){return b.toUpperCase()}),(d=a.style[c])||(a.currentStyle?d=a.currentStyle[c]:e.getComputedStyle&&(d=e.getComputedStyle(a,"").getPropertyValue(b))));return d||""}var b,c;c=Infinity;b=document.body;var d,e=1,f=0,g;b=b.childNodes;for(g=b.length;f<g;)d=b[f++],1==d.nodeType&&(d=parseInt(a(d,"z-index"))||0,d>e&&d<=c&&(e=d));return e},buildFrame:function(){var a=cbf.highZIndex(),b=this.frameParams,c=b.appendTo?cbf.getDiv(b.appendTo):null;if(c){var d=cbf.byId("cbfFrame");null===d&&(d=cbf.addDiv("cbfFrame",
b.appendTo,b.setBefore));d.addDiv("cbfContainer","cbfFrame")}else cbf.addDiv("cbfOverlay"),cbf.css("cbfOverlay",{display:"block",position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%","background-color":"#000000","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)",filter:"alpha(opacity=50)","-moz-opacity":"0.5","-khtml-opacity":"0.5",opacity:"0.5"}),cbf.setZIndex("cbfOverlay",a+10002),cbf.byId("cbfOverlay").backgroundColor="#000000",cbf.byId("cbfOverlay").style.backgroundColor=
"#000000",cbf.byId("cbfOverlay").style.opacity=0.5,cbf.addDiv("cbfScreen"),cssScreen={display:"block",position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%","overflow-y":"auto"},cbf.css("cbfScreen",cssScreen),cbf.byId("cbfScreen").style.overflowY="auto",cbf.setZIndex("cbfScreen",a+10003),cbf.addDiv("cbfFrame","cbfScreen").addDiv("cbfContainer","cbfFrame"),b.closeButton&&(cbf.addDiv("cbfCloseBtn","cbfFrame"),cbf.byId("cbfCloseBtn").title="Close",d={position:"absolute",top:"-18px",right:"-18px",
width:"36px",height:"36px",cursor:"pointer",background:"url('"+cbf.getCatBeeUrl()+"public/res/images/Navigation.png')","background-color":"transparent"},cbf.css("cbfCloseBtn",d).addEvt("cbfCloseBtn","click",function(){cbf.closeFrame()}),cbf.setZIndex("cbfCloseBtn",a+10010));d={width:b.initWidth+"px",height:b.initHeight+"px"};cbf.css("cbfFrame",d);c?(c=c.offsetWidth,c=Math.round(100*((c/2-b.initWidth/2)/c)),d={position:"relative",left:c+"%"}):(c=cbf.viewPort().width,c=Math.round(100*((c/2-b.initWidth/
2)/c)),d={display:"block",position:"absolute",top:"5%",left:c+"%","border-radius":"10px","-moz-border-radius":"10px","-webkit-border-radius":"10px"," -khtml-border-radius":"10px",background:"#FFF",color:"#FFF",border:"5px solid rgba(12, 80, 182, 0.2)"});cbf.css("cbfFrame",d);cbf.setZIndex("cbfFrame",a+10004);cbf.css("cbfContainer",{width:"100%",height:"100%"});cbf.setupRpc(b);cbf.byId("cbfContainer").focus()},closeFrame:function(){null==cbf.valOrDefault(cbf.byId("cbfOverlay"),null)?cbf.css("cbfFrame",
{display:"none"}):(cbf.css("cbfScreen",{display:"none"}),cbf.css("cbfOverlay",{display:"none"}))},setupFrame:function(a){cbf.hasFrame||(cbf.hasFrame=!0,this.frameParams=a,"undefined"==typeof esyXDM?("undefined"==typeof JSON&&(a=cbf.getCatBeeUrl()+"public/res/js/min/json2.min.js",cbf.loadScript(a)),a=cbf.getCatBeeUrl()+"public/res/js/min/easyXDM.min.js?v=1",cbf.loadScript(a,function(){cbf.buildFrame()})):cbf.buildFrame())},askApi:function(a,b,c){if("undefined"==typeof JSON){var d=cbf.getCatBeeUrl()+
"public/res/js/min/json2.min.js";cbf.loadScript(d)}a=cbf.getCatBeeUrl()+"api/"+a+"/";xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState&&200==xmlhttp.status)try{var a=JSON.parse(xmlhttp.responseText);null!==c&&c(a)}catch(b){}};try{b?(xmlhttp.open("POST",a,!0),xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmlhttp.send(b)):(xmlhttp.open("GET",a,!0),xmlhttp.setRequestHeader("Content-Type",
"application/x-www-form-urlencoded"),xmlhttp.send())}catch(e){}}};
cbWidgets={postPurchaseWidget:function(a){function b(a,b){var e=cbf.getCookie("CatBeeRefId");e&&(a.successfulReferral=e);cbf.setupFrame({initWidth:424,initHeight:372,catbeeAction:"deal",urlParams:a,closeButton:b.closeButton,appendTo:b.appendTo,setBefore:b.setBefore})}cbf.valOrDefault(cbfSettings.widgets.ppw.gui,null)?cbfSettings.widgets.ppw.sites.run&&b(a,cbfSettings.gui):cbf.askApi("store","action=get+config&context%5BshopId%5D="+a.branch.shopId+"&context%5BwidgetId%5D=1",function(c){guiParams=0<
c.length&&cbf.valOrDefault(c[0].gui,null)?c[0].gui:{closeButton:!0,appendTo:null};b(a,guiParams)})},welcomeWidget:function(){}};window.cbf=cbf;cbfSettings={widgets:{fww:{gui:{closeButton:!0},sites:{run:!0}},ppw:{gui:{closeButton:!0},sites:{run:!0}},cpn:{gui:{appendTo:"coupon_code"},sites:{run:!0}}}};window.cbfSettings=cbfSettings;cbf.hasFrame=!1;window.cbWidgets=cbWidgets;